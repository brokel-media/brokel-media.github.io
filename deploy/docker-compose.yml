services:
  web:
    image: caddy:2
    ports:
      - "80:80"
    volumes:
      - ../_site:/srv:ro
      - ./Caddyfile:/etc/caddy/Caddyfile:ro
      - caddy_data:/data
      - caddy_config:/config
    depends_on:
      - remark42

  remark42:
    image: umputun/remark42:latest
    environment:
      - SITE=brokel
      - REMARK_URL=http://comments.local
      # simplest while youâ€™re also gating the whole site later (Cloudflare Access):
      - AUTH_ANON=true
      - SECRET=some-very-secret-string
    volumes:
      - remark42_data:/srv/var

volumes:
  caddy_data:
  caddy_config:
  remark42_data:
